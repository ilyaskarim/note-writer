<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JetBrains Prompt Writer</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="scripts/tailwind.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        jb: {
                            bg: '#2b2b2b',
                            sidebar: '#313335',
                            header: '#3c3f41',
                            text: '#a9b7c6',
                            border: '#323232',
                            accent: '#365880',
                            hover: '#4b6eaf',
                            listHover: '#2d2f30',
                            active: '#4b6eaf',
                            success: '#629755'
                        }
                    },
                    animation: {
                        'modal-in': 'modal-in 0.2s ease-out'
                    },
                    keyframes: {
                        'modal-in': {
                            '0%': { opacity: '0', transform: 'scale(0.95) translateY(-10px)' },
                            '100%': { opacity: '1', transform: 'scale(1) translateY(0)' }
                        }
                    },
                    fontFamily: {
                        mono: ['"JetBrains Mono"', 'monospace'],
                    }
                }
            }
        }
    </script>
    
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="h-screen w-screen overflow-hidden bg-jb-bg text-jb-text text-sm font-mono">
    <div id="app" class="flex h-full w-full">
        <!-- Sidebar -->
        <aside 
            :class="[
                'w-64 bg-jb-sidebar border-r border-jb-border flex flex-col flex-shrink-0 relative z-20 shadow-xl transition-all duration-300',
                sidebarOpen ? 'ml-0' : '-ml-64'
            ]"
        >
            <div class="h-[45px] flex items-center px-4 border-b border-jb-border font-bold text-xs tracking-wide bg-jb-header select-none">
                DOCUMENTS
            </div>
            
            <ul class="flex-1 overflow-y-auto">
                <li 
                    v-for="doc in sortedDocs" 
                    :key="doc.id"
                    :class="[
                        'group relative px-4 py-3 cursor-pointer border-b border-jb-border text-xs flex flex-col gap-1 transition-colors',
                        doc.id === currentDocId 
                            ? 'bg-jb-active text-white' 
                            : 'hover:bg-jb-listHover text-jb-text'
                    ]"
                    @click="switchDocument(doc.id)"
                >
                    <div class="font-medium truncate pr-6">{{ getDisplayTitle(doc) }}</div>
                    <span class="text-[10px] opacity-70">{{ formatDate(doc.createdAt) }}</span>
                    <div 
                        class="absolute right-2 top-3 hidden group-hover:flex items-center justify-center text-gray-400 hover:text-red-400 p-1 rounded hover:bg-[#252526] transition-all"
                        @click.stop="deleteDocument(doc.id)"
                    >
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        </svg>
                    </div>
                </li>
            </ul>

            <button 
                class="w-full py-3 bg-jb-accent text-white hover:bg-jb-hover border-t border-jb-border transition-colors text-xs font-bold"
                @click="createNewDocument"
            >
                + NEW DOCUMENT
            </button>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col min-w-0">
            <!-- Header -->
            <header class="h-[45px] bg-jb-header border-b border-jb-border flex items-center px-4 gap-3">
                <button 
                    class="text-jb-text hover:text-white text-xl focus:outline-none transition-colors"
                    @click="toggleSidebar"
                >
                    â˜°
                </button>
                
                <input 
                    type="text" 
                    v-model="docTitle"
                    class="bg-jb-bg border border-[#646464] text-jb-text text-sm px-2 py-1 rounded w-64 focus:border-jb-accent focus:outline-none transition-colors placeholder-gray-500"
                    placeholder="Untitled Document"
                    @blur="saveCurrentDocument(true)"
                    @keydown.enter="onTitleEnter"
                >
                
                <div class="flex-1"></div>
                
                <span class="text-xs text-gray-500 hidden sm:block">{{ statusMessage }}</span>
                
                <button 
                    class="bg-jb-accent hover:bg-jb-hover text-white border border-[#4c7095] px-3 py-1 rounded text-xs transition-colors shadow-sm"
                    @click="saveCurrentDocument(true)"
                >
                    Save
                </button>
                
                <button 
                    :class="[
                        'px-3 py-1 rounded text-xs transition-colors shadow-sm text-white border',
                        copied 
                            ? 'bg-jb-success border-jb-success' 
                            : 'bg-jb-accent hover:bg-jb-hover border-[#4c7095]'
                    ]"
                    @click="copyPrompt"
                >
                    {{ copied ? 'Copied!' : 'Copy Prompt' }}
                </button>
            </header>

            <!-- Editor -->
            <div id="editor-container" class="flex-1 overflow-hidden relative"></div>
        </div>

        <!-- Delete Confirmation Modal -->
        <Transition name="modal">
            <div 
                v-if="showDeleteModal" 
                class="fixed inset-0 z-50 flex items-center justify-center"
                @click.self="cancelDelete"
            >
                <!-- Backdrop -->
                <div class="absolute inset-0 bg-black/60 backdrop-blur-sm"></div>
                
                <!-- Modal -->
                <div class="relative bg-jb-sidebar border border-jb-border rounded-lg shadow-2xl w-[400px] overflow-hidden animate-modal-in">
                    <!-- Header -->
                    <div class="flex items-center gap-3 px-5 py-4 border-b border-jb-border bg-jb-header">
                        <div class="w-10 h-10 rounded-full bg-red-500/20 flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M3 6h18"></path>
                                <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                <line x1="14" y1="11" x2="14" y2="17"></line>
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-white font-bold text-sm">Delete Document</h3>
                            <p class="text-jb-text text-xs opacity-70">This action cannot be undone</p>
                        </div>
                    </div>
                    
                    <!-- Body -->
                    <div class="px-5 py-4">
                        <p class="text-jb-text text-sm leading-relaxed">
                            Are you sure you want to delete 
                            <span class="text-white font-medium">"{{ deleteDocTitle }}"</span>? 
                            This document will be permanently removed.
                        </p>
                    </div>
                    
                    <!-- Footer -->
                    <div class="flex justify-end gap-3 px-5 py-4 border-t border-jb-border bg-jb-bg/50">
                        <button 
                            class="px-4 py-2 rounded text-sm text-jb-text hover:text-white hover:bg-jb-listHover border border-jb-border transition-all"
                            @click="cancelDelete"
                        >
                            Cancel
                        </button>
                        <button 
                            class="px-4 py-2 rounded text-sm text-white bg-red-600 hover:bg-red-500 border border-red-500 transition-all shadow-lg shadow-red-500/20"
                            @click="confirmDelete"
                        >
                            Delete
                        </button>
                    </div>
                </div>
            </div>
        </Transition>
    </div>

    <!-- Monaco Editor -->
    <script src="scripts/monaco/vs/loader.min.js"></script>
    
    <!-- Vue.js -->
    <script src="scripts/vue.global.js"></script>
    
    <!-- App -->
    <script src="js/app.js"></script>
</body>
</html>
